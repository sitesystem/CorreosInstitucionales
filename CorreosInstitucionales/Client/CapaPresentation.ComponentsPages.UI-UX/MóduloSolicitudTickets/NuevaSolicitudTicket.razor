@page "/NuevaSolicitudTicket"
@* attribute [Authorize(Policy = "[Rol] Usuario Solicitante")] *@

<PageTitle>@Title</PageTitle>

<SolicitudEditor registro="registro" 
    cat_SolIdEstadoSolicitud="cat_SolIdEstadoSolicitud"
    cat_SolIdTipoSolicitud="cat_SolIdTipoSolicitud"
    cat_SolIdUsuario="cat_SolIdUsuario"
/>

@code
    {
    string Title = "Registro de Solicitud";
    RequestDTO_Solicitud registro = new RequestDTO_Solicitud();

    public List<RequestViewModel_EstadoSolicitud> cat_SolIdEstadoSolicitud { get; private set; } = new List<RequestViewModel_EstadoSolicitud>();
    public List<RequestViewModel_TipoSolicitud> cat_SolIdTipoSolicitud { get; private set; } = new List<RequestViewModel_TipoSolicitud>();
    public List<RequestDTO_Usuario> cat_SolIdUsuario { get; private set; } = new List<RequestDTO_Usuario>();

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            registro.SolIdEstadoSolicitud = 1;
            registro.SolIdTipoSolicitud = 1;
            registro.SolIdUsuario = 0;
            cat_SolIdEstadoSolicitud = await WebUtils.ListByStatusAsync(servicioEstadoSolicitud);
            cat_SolIdTipoSolicitud = await WebUtils.ListByStatusAsync(servicioTipoSolicitud);
            
            StateHasChanged();
        }
    }
}
