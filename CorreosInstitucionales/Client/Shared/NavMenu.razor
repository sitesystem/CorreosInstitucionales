<style type="text/css">
</style>

<AuthorizeView Policy="[Rol] Usuario Solicitante">
    <Authorized>
        @*************************** Dashboard (Panel de Control) ***************************@
        <RadzenPanelMenuItem Text="Inicio" Icon="home" IconColor="@Colors.White" Path="Inicio" Style="font-size:16px;" class="nav-menu-hover" />
        <RadzenPanelMenuItem Text="Módulos" style="font-variant: small-caps; font-size:16px;" class="nav-menu-hover" />
        @*************************** Módulo de Solicitudes (Tickets) ***************************@
        <RadzenPanelMenuItem Text="@($@"Solicitudes de Tickets")" Icon="bookmarks" IconColor="@Colors.PrimaryLight" Style="font-size:16px;" Expanded="@isExpanded" class="nav-menu-hover">
            @*************************** Levantamiento del Nuevo Ticket ***************************@
            <RadzenPanelMenuItem Text="Nueva Solicitud de Ticket" Icon="local_offer" IconColor="@Colors.Warning" Path="NuevaSolicitudTicket" class="nav-menu-hover" />
            @*************************** Solicitudes (Ticket's) Pendientes y Atendidas ***************************@
            <RadzenPanelMenuItem Text="@($@"Historial de Solicitudes [ {oSolicitudes?.Message} Tickets ]")" Icon="hourglass_bottom" IconColor="@Colors.SuccessLight" Path="HistorialSolicitudesTickets" class="nav-menu-hover" />
        </RadzenPanelMenuItem>
        @*************************** Perfil ***************************@
        <RadzenPanelMenuItem Text="Perfil" Icon="account_circle" IconColor="@Colors.InfoLight" Style="font-size:16px;" Path="PerfilUsuario" class="nav-menu-hover" />
    </Authorized>
    <Authorizing>
    </Authorizing>
    <NotAuthorized>
    </NotAuthorized>
</AuthorizeView>

<AuthorizeView Policy="[Rol] Administrador">
    <Authorized>
        @*************************** Dashboard (Panel de Control) ***************************@
        <RadzenPanelMenuItem Text="Inicio (Panel de Control)" Icon="home" IconColor="@Colors.White" Path="Inicio" Style="font-size:16px;" class="nav-menu-hover" />
        <RadzenPanelMenuItem Text="Módulos" style="font-variant: small-caps; font-size:16px;" class="nav-menu-hover" />
        @*************************** Módulo de Solicitudes (Tickets) ***************************@
        <RadzenPanelMenuItem Text="Solicitudes de (Tickets)" Icon="bookmarks" IconColor="@Colors.PrimaryLight" Style="font-size:16px;" Expanded="true" class="nav-menu-hover">
            @*************************** Solicitudes (Ticket's) Pendientes ***************************@
            <RadzenPanelMenuItem Text="Solicitudes Pendientes" Icon="sell" IconColor="@Colors.PrimaryLight" Path="SolicitudesPendientes" class="nav-menu-hover" />
            @*************************** Solicitudes (Ticket's) en Proceso ***************************@
            <RadzenPanelMenuItem Text="Solicitudes en Proceso" Icon="hourglass_empty" IconColor="@Colors.Warning" Path="SolicitudesProceso" class="nav-menu-hover" />
            @*************************** Solicitudes (Ticket's) Atendidas ***************************@
            <RadzenPanelMenuItem Text="Solicitudes Atendidas" Icon="bookmark" IconColor="@Colors.SuccessLight" Path="SolicitudesAtendidas" class="nav-menu-hover" />
        </RadzenPanelMenuItem>
        @*************************** Módulo de Catálogos ***************************@
        <RadzenPanelMenuItem Text="Catálogos" Icon="settings" IconColor="@Colors.Base400" Style="font-size:16px;" Expanded="@isExpanded">
            @*************************** catÁreasDeptos ***************************@
            <RadzenPanelMenuItem Text="Áreas / Departamentos" Icon="lan" IconColor="@Colors.Base400" Path="catalogo/areas_departamentos" class="rz-border-base-800" />
            @*************************** catExtensiones ***************************@
            <RadzenPanelMenuItem Text="Números de Extensión" Icon="phone" IconColor="@Colors.Base400" Path="catalogo/extensiones" class="rz-border-base-800" />
            @*************************** catEdificios ***************************@
            <RadzenPanelMenuItem Text="Edificios" Icon="domain" IconColor="@Colors.Base400" Path="catalogo/edificios" class="rz-border-base-800" />
            @*************************** catPisosNiveles ***************************@
            <RadzenPanelMenuItem Text="Pisos (Niveles)" Icon="stairs" IconColor="@Colors.Base400" Path="catalogo/pisos" class="rz-border-base-800" />
            @*************************** catLinks ***************************@
            <RadzenPanelMenuItem Text="Enlaces Web (Links)" Icon="insert_link" IconColor="@Colors.Base400" Path="catalogo/enlaces" class="rz-border-base-800" />
            @*************************** catCarreras ***************************@
            <RadzenPanelMenuItem Text="Carreras / Licenciaturas" Icon="school" IconColor="@Colors.Base400" Path="catalogo/carreras" class="rz-border-base-800" />
            @*************************** catDatosEscuela ***************************@
            <RadzenPanelMenuItem Text="Datos de la Escuela" Icon="apartment" IconColor="@Colors.Base400" Path="catalogo/escuelas" class="rz-border-base-800" />
            @*************************** catTiposSolicitudTicket ***************************@
            <RadzenPanelMenuItem Text="Tipos de Solicitud" Icon="assignment" IconColor="@Colors.Base400" Path="catalogo/tipos_solicitud" class="rz-border-base-800" />
            @*************************** catTiposPersonal ***************************@
            <RadzenPanelMenuItem Text="Tipos de Personal" Icon="supervisor_account" Path="catalogo/tipos_personal" class="rz-border-base-800" />
            @*************************** catEstadosSolicitud ***************************@
            <RadzenPanelMenuItem Text="Estados de Solicitud" Icon="device_hub" Path="catalogo/estados_solicitud" class="rz-border-base-800" />
            @*************************** Solicitudes ***************************@
            <RadzenPanelMenuItem Text="Solicitudes" Icon="bookmarks" Path="catalogo/solicitudes" class="rz-border-base-800" />

        </RadzenPanelMenuItem>

        @*************************** DEBUG ***************************@
        <RadzenPanelMenuItem Text="DEBUG" Icon="extension" IconColor="@Colors.Success" Style="font-size:16px;">
            <RadzenPanelMenuItem Text="Objecto a UI" Icon="label_outline" Path="debug/catalogos" class="rz-border-base-800" />
            <RadzenPanelMenuItem Text="Correos (y mensajes por WA)" Icon="markunread_mailbox" Path="debug/correos" class="rz-border-base-800" />
            <RadzenPanelMenuItem Text="Settings" Icon="settings" Path="debug/settings" class="rz-border-base-800" />
        </RadzenPanelMenuItem>

        @*************************** tbUsuarios ***************************@
        <RadzenPanelMenuItem Text="Lista de Usuarios" Icon="people_alt" IconColor="@Colors.SecondaryLight" Style="font-size:16px;" Path="catalogo/usuarios" />
        @*************************** Perfil ***************************@
        <RadzenPanelMenuItem Text="Perfil" Icon="account_circle" IconColor="@Colors.InfoLight" Style="font-size:16px;" Path="PerfilUsuario" class="nav-menu-hover" />
    </Authorized>
    <Authorizing>
    </Authorizing>
    <NotAuthorized>
    </NotAuthorized>
</AuthorizeView>

@*************************** Cerrar Sesión (LogOut) ***************************@
<RadzenPanelMenuItem Text="Cerrar Sesión" Icon="logout" IconColor="@Colors.DangerLight" Style="font-size:16px;" Click="@LogOut" class="nav-menu-hover" />

@code
{
    [Parameter]
    public bool isExpanded { get; set; }

    private Response<List<RequestDTO_Solicitud>>? oSolicitudes = new();

    protected override async Task OnInitializedAsync()
    {
        
        var authState = await servicioAuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;

        if (user.Identity is not null && user.Identity.IsAuthenticated)
        {
            int id = Convert.ToInt32(user.Claims.FirstOrDefault(c => c.Type == "ID")?.Value);
            oSolicitudes = await servicioSolicitud.GetAllDataByIdUsuarioAsync(id);
        }
    }

    private async Task LogOut()
    {
        await loginService.Logout();
        navigationManager.NavigateTo("/");
    }
}
